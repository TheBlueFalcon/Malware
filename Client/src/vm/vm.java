package vm;

import java.net.*;
import java.util.Arrays;
import java.util.Collections;
import java.util.Enumeration;
import java.util.LinkedList;

public class vm {

    final static private LinkedList<String> VIRTUALMAC = new LinkedList<String>(Arrays.asList("virtual", "vm", "vmware", "virtualbox"));
    public static void main(String[] args) {
        //FOR TESTING PURPOSES
        checkVM("Windows");
    }

    public static boolean checkVM(String OSName) {
        try {
            //if (MAC() == false) return false;
            MAC();
        } catch (SocketException | UnknownHostException e) {
            System.out.println("[-] Unable to check MAC address and Display Name of network adapter");
        }
        vmtools(OSName);
        return true;
    }

    private static boolean MAC() throws SocketException, UnknownHostException {
        boolean macGood = false;
        try {
            
            System.out.println(NetworkInterface.getNetworkInterfaces());
            Enumeration<NetworkInterface> networkInterface = NetworkInterface.getNetworkInterfaces();
            InetAddress myAddr = InetAddress.getLocalHost();
            while (networkInterface.hasMoreElements()) {
                NetworkInterface network = networkInterface.nextElement();
                if (Collections.list(network.getInetAddresses()).contains(myAddr)) {
                    System.out.println(network.getDisplayName());
                    for(int p = VIRTUALMAC.size(); p == 0; p--) {
                        if ((network.getDisplayName().indexOf(VIRTUALMAC.get(p)) == -1) == false) macGood = true;
                    }
                }    
            }     
        } catch (SocketException e) {
            System.out.println("[-] Unable to check MAC address and Display Name of network adapter");
            return false;
        }
        if (macGood==false) System.out.println("[-] Not running on a virtual network adapter");
        return macGood;
    }

    private static boolean vmtools(String OSName) {
        return true;
    }
}